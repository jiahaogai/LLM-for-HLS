This function should be equivalent to the original C/C++ function `kernel_mvt` (no semantic difference).